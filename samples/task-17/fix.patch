diff --git a/pkg/agent/proxy/integrations/http/chunk.go b/pkg/agent/proxy/integrations/http/chunk.go
index d73d8aca..4c99396b 100644
--- a/pkg/agent/proxy/integrations/http/chunk.go
+++ b/pkg/agent/proxy/integrations/http/chunk.go
@@ -44,15 +44,26 @@ func (h *HTTP) HandleChunkedRequests(ctx context.Context, finalReq *[]byte, clie
 	}
 
 	lines := strings.Split(string(*finalReq), "\n")
-	var contentLengthHeader string
-	var transferEncodingHeader string
+	var contentLengthHeader, transferEncodingHeader string
 	for _, line := range lines {
-		if strings.HasPrefix(line, "Content-Length:") {
-			contentLengthHeader = strings.TrimSpace(strings.TrimPrefix(line, "Content-Length:"))
-			break
-		} else if strings.HasPrefix(line, "Transfer-Encoding:") {
-			transferEncodingHeader = strings.TrimSpace(strings.TrimPrefix(line, "Transfer-Encoding:"))
-			break
+		line = strings.TrimRight(line, "\r")
+		if line == "" {
+			continue
+		}
+
+		parts := strings.SplitN(line, ":", 2)
+		if len(parts) != 2 {
+			continue
+		}
+
+		key := strings.ToLower(strings.TrimSpace(parts[0]))
+		val := strings.TrimSpace(parts[1])
+
+		switch key {
+		case "content-length":
+			contentLengthHeader = val
+		case "transfer-encoding":
+			transferEncodingHeader = val
 		}
 	}
 
@@ -219,15 +230,28 @@ func (h *HTTP) handleChunkedResponses(ctx context.Context, finalResp *[]byte, cl
 	var contentLengthHeader, transferEncodingHeader string
 	lines := strings.Split(string(resp), "\n")
 	for _, line := range lines {
-		if strings.HasPrefix(line, "Content-Length:") {
-			contentLengthHeader = strings.TrimSpace(strings.TrimPrefix(line, "Content-Length:"))
-			break
-		} else if strings.HasPrefix(line, "Transfer-Encoding:") {
-			transferEncodingHeader = strings.TrimSpace(strings.TrimPrefix(line, "Transfer-Encoding:"))
-			break
+		line = strings.TrimRight(line, "\r") // remove trailing \r if present
+		if line == "" {
+			continue
+		}
+
+		// Split key: value
+		parts := strings.SplitN(line, ":", 2)
+		if len(parts) != 2 {
+			continue
+		}
+
+		key := strings.ToLower(strings.TrimSpace(parts[0]))
+		val := strings.TrimSpace(parts[1])
+
+		switch key {
+		case "content-length":
+			contentLengthHeader = val
+		case "transfer-encoding":
+			transferEncodingHeader = val
 		}
 	}
-	//Handle chunked responses
+
 	if contentLengthHeader != "" {
 		contentLength, err := strconv.Atoi(contentLengthHeader)
 		if err != nil {
@@ -243,13 +267,11 @@ func (h *HTTP) handleChunkedResponses(ctx context.Context, finalResp *[]byte, cl
 			}
 		}
 	} else if transferEncodingHeader != "" {
-		//check if the initial response is the complete response.
-		if strings.HasSuffix(string(*finalResp), "0\r\n\r\n") {
-			return nil
-		}
-		if transferEncodingHeader == "chunked" {
-			err := h.chunkedResponse(ctx, finalResp, clientConn, destConn)
-			if err != nil {
+		if strings.Contains(strings.ToLower(transferEncodingHeader), "chunked") {
+			if strings.HasSuffix(string(*finalResp), "0\r\n\r\n") {
+				return nil
+			}
+			if err := h.chunkedResponse(ctx, finalResp, clientConn, destConn); err != nil {
 				return err
 			}
 		}
